module.exports = [
"[project]/node_modules/@turnkey/core/dist/__storage__/mobile/storage.mjs [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "MobileStorageManager",
    ()=>MobileStorageManager
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$turnkey$2f$core$2f$dist$2f$_$5f$types_$5f2f$enums$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@turnkey/core/dist/__types__/enums.mjs [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$turnkey$2f$core$2f$dist$2f$utils$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@turnkey/core/dist/utils.mjs [app-ssr] (ecmascript)");
;
;
let AsyncStorage;
try {
    const mod = (()=>{
        const e = new Error("Cannot find module '@react-native-async-storage/async-storage'");
        e.code = 'MODULE_NOT_FOUND';
        throw e;
    })();
    AsyncStorage = mod.default ?? mod;
} catch  {
    throw new Error("Please install @react-native-async-storage/async-storage in your app to use MobileStorageManager");
}
class MobileStorageManager {
    constructor(){
        this.getStorageValue = async (sessionKey)=>{
            const item = await AsyncStorage.getItem(sessionKey);
            return item ? JSON.parse(item) : undefined;
        };
        this.setStorageValue = async (sessionKey, storageValue)=>{
            await AsyncStorage.setItem(sessionKey, JSON.stringify(storageValue));
        };
        this.setActiveSessionKey = async (sessionKey)=>{
            await this.setStorageValue(MobileStorageManager.ACTIVE_SESSION_KEY, sessionKey);
        };
        this.removeStorageValue = async (sessionKey)=>{
            await AsyncStorage.removeItem(sessionKey);
        };
        this.storeSession = async (session, sessionKey = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$turnkey$2f$core$2f$dist$2f$_$5f$types_$5f2f$enums$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["SessionKey"].DefaultSessionkey)=>{
            const sessionWithMetadata = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$turnkey$2f$core$2f$dist$2f$utils$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["parseSession"])(session);
            await this.setStorageValue(sessionKey, sessionWithMetadata);
            const raw = await this.getStorageValue(MobileStorageManager.ALL_SESSION_KEYS);
            const keys = Array.isArray(raw) ? raw : [];
            if (!keys.includes(sessionKey)) {
                keys.push(sessionKey);
                await this.setStorageValue(MobileStorageManager.ALL_SESSION_KEYS, keys);
            }
            await this.setStorageValue(MobileStorageManager.ACTIVE_SESSION_KEY, sessionKey);
        };
        this.getSession = async (sessionKey = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$turnkey$2f$core$2f$dist$2f$_$5f$types_$5f2f$enums$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["SessionKey"].DefaultSessionkey)=>{
            return this.getStorageValue(sessionKey);
        };
        this.getActiveSessionKey = async ()=>{
            return this.getStorageValue(MobileStorageManager.ACTIVE_SESSION_KEY);
        };
        this.getActiveSession = async ()=>{
            const key = await this.getActiveSessionKey();
            return key ? this.getSession(key) : undefined;
        };
        this.listSessionKeys = async ()=>{
            const raw = await this.getStorageValue(MobileStorageManager.ALL_SESSION_KEYS);
            return Array.isArray(raw) ? raw : [];
        };
        this.clearSession = async (sessionKey)=>{
            await this.removeStorageValue(sessionKey);
            const keys = await this.listSessionKeys();
            const updated = keys.filter((k)=>k !== sessionKey);
            await this.setStorageValue(MobileStorageManager.ALL_SESSION_KEYS, updated);
            const active = await this.getActiveSessionKey();
            if (active === sessionKey) {
                await this.removeStorageValue(MobileStorageManager.ACTIVE_SESSION_KEY);
            }
        };
        this.clearAllSessions = async ()=>{
            const keys = await this.listSessionKeys();
            await Promise.all(keys.map((k)=>AsyncStorage.removeItem(k)));
            await this.removeStorageValue(MobileStorageManager.ALL_SESSION_KEYS);
            await this.removeStorageValue(MobileStorageManager.ACTIVE_SESSION_KEY);
        };
    }
}
MobileStorageManager.ALL_SESSION_KEYS = "@turnkey/all-session-keys";
MobileStorageManager.ACTIVE_SESSION_KEY = "@turnkey/active-session-key";
;
 //# sourceMappingURL=storage.mjs.map
}),
];

//# sourceMappingURL=node_modules_%40turnkey_core_dist___storage___mobile_storage_mjs_9d7aa6dc._.js.map